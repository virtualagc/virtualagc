<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta content="text/html;charset=ISO-8859-1" http-equiv="Content-Type">
<title>Assembly listing generated by yaYUL</title>
<style type="text/css">
p.nobreak { white-space:nowrap; }
a { text-decoration:none; }
a:visited { COLOR: #000850; }
</style>
<style type="text/css">
.op{
font-weight: bold;
color: #993300;
}
</style>
<style type="text/css">
.dn{
color: #009900;
}
</style>
<style type="text/css">
.fe{
color: #FF0000;
}
</style>
<style type="text/css">
.in{
color: #FF6600;
}
</style>
<style type="text/css">
.ps{
color: #336600;
}
</style>
<style type="text/css">
.sm{
color: #0000FF;
}
</style>
<style type="text/css">
.wn{
color: #FF9900;
}
</style>
<style type="text/css">
.co{
font-style: italic;
color: #993399;
}
</style>
</head>
<body>
<p class="nobreak">
<span style="font-family: monospace;">
<pre>
<h1>Source Code</h1>
</pre>
</span>
</p>
<table style="text-align: left;" border="1" cellpadding="2" cellspacing="2">
<tbody>
<tr>
<td style="white-space: nowrap; vertical-align: middle;">
<img alt="" src="Apollo32.png" style="width: 32px; height: 32px;" align="left">
</td>
<td style="vertical-align: middle;">
These source-code files derive from a printout of Luminary 116 (the Apollo 12
Lunar Module guidance computer program), from the personal library of 
original AGC developer Don Eyles, digitally photographed at archive.org, 
financially sponsored by Ron Burkey, and transcribed to source code by a
team of volunteers.  This colorized, syntax-highlighted form was created
by assembling that transcribed source code.  Note that the full page images
are available <a href="https://archive.org/details/luminary11600nasa">on the
Virtual AGC project page at archive.org</a>, while reduced-size images
<a href="http://www.ibiblio.org/apollo/ScansForConversion/Luminary116/">
are presented at the VirtualAGC project website</a>.  Report or fix any 
transcription errors at <a href="https://github.com/virtualagc/virtualagc/issues/">
the Virtual AGC project code repository</a>.<br><br> 
Notations on the program listing read, in part:<br>
<br>
<pre>
	GAP:  ASSEMBLE REVISION 116 OF AGC PROGRAM LUMINARY BY NASA 2021112-071
	19:09 AUG. 11,1969
</pre>
Note that the date is the date of the printout, not the date of the program revision.
</td></tr></tbody></table>

<p class="nobreak">
<span style="font-family: monospace;">
<pre>
056295,000002:                                                                                                  <span class="co">## Copyright:   Public domain.</span>
056296,000003:                                                                                                  <span class="co">## Filename:    KEYRUPT,_UPRUPT.agc</span>
056297,000004:                                                                                                  <span class="co">## Purpose:     A section of Luminary revision 116.</span>
056298,000005:                                                                                                  <span class="co">##              It is part of the source code for the Lunar Module's (LM) </span>
056299,000006:                                                                                                  <span class="co">##              Apollo Guidance Computer (AGC) for Apollo 12.</span>
056300,000007:                                                                                                  <span class="co">##              This file is intended to be a faithful transcription, except</span>
056301,000008:                                                                                                  <span class="co">##              that the code format has been changed to conform to the</span>
056302,000009:                                                                                                  <span class="co">##              requirements of the yaYUL assembler rather than the</span>
056303,000010:                                                                                                  <span class="co">##              original YUL assembler.</span>
056304,000011:                                                                                                  <span class="co">## Reference:   pp. 1328-1330</span>
056305,000012:                                                                                                  <span class="co">## Assembler:   yaYUL</span>
056306,000013:                                                                                                  <span class="co">## Contact:     Ron Burkey &lt;info@sandroid.org>.</span>
056307,000014:                                                                                                  <span class="co">## Website:     www.ibiblio.org/apollo/index.html</span>
056308,000015:                                                                                                  <span class="co">## Mod history: 2017-01-22 MAS  Created from Luminary 99.</span>
056309,000016:                                                                                                  <span class="co">##              2017-02-03 RRB  Updated for Luminary 116.</span>
056310,000017:                                                                                                  <span class="co">##              2017-03-13 RSB  Proofed comment text via 3-way diff vs</span>
056311,000018:                                                                                                  <span class="co">##                              Luminary 99 and 131.</span>
056312,000019: 
</pre>
</span>
</p>
<table style="text-align: left;" border="1" cellpadding="2" cellspacing="2">
<tbody>
<tr>
<td style="white-space: nowrap; vertical-align: middle;">
<img alt="" src="Apollo32.png" style="width: 32px; height: 32px;" align="left">
</td>
<td style="vertical-align: middle;">
Page 1328
</td></tr></tbody></table>
<p class="nobreak">
<span style="font-family: monospace;">
<pre>
056314,000021: 14,3775                                           <span class="ps">BANK    </span> 14                                    
056315,000022: 04,2000                                           <span class="ps">SETLOC  </span> <a href="TAGS_FOR_RELATIVE_SETLOC_AND_BLANK_BANK_CARDS.agc.html#4B455952555054">KEYRUPT</a>                               
056316,000023: 04,2000                                           <span class="ps">BANK    </span>                                       
056317,000024: 04,3256                                           <span class="ps">COUNT*  </span> $$/KEYUP                              
056318,000025: 
<a name="4B45595255505431"></a>056319,000026: 04,3256           54016        <span class="sm">KEYRUPT1</span>           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#42414E4B52555054">BANKRUPT</a>                              
056320,000027: 04,3257           56002                           <span class="op">XCH     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#51">Q</a>                                     
056321,000028: 04,3260           54012                           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#5152555054">QRUPT</a>                                 
056322,000029: 04,3261           04400                           <span class="op">TC      </span> <a href="PINBALL_GAME__BUTTONS_AND_LIGHTS.agc.html#4C4F4453414D5054">LODSAMPT</a>                              <span class="co">#  TIME IS SNATCHED IN RUPT FOR NOUN 65.</span>
056323,000030: 04,3262           34346                           <span class="op">CAF     </span> <a href="PINBALL_GAME__BUTTONS_AND_LIGHTS.agc.html#4C4F5735">LOW5</a>                                  
056324,000031: 04,3263           00006                           <span class="op">EXTEND  </span>                                       
056325,000032: 04,3264           02015                           <span class="op">RAND    </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4D4E4B4559494E">MNKEYIN</a>                               <span class="co">#  CHECK IF KEYS 5M-1M ON</span>
<a name="4B4559434F4D"></a>056326,000033: 04,3265           54073        <span class="sm">KEYCOM  </span>           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#5255505452454734">RUPTREG4</a>                              
056327,000034: 04,3266           40101                           <span class="op">CS      </span> <a href="FLAGWORD_ASSIGNMENTS.agc.html#464C414757524435">FLAGWRD5</a>                              
056328,000035: 04,3267           74735                           <span class="op">MASK    </span> <a href="FLAGWORD_ASSIGNMENTS.agc.html#44534B5946424954">DSKYFBIT</a>                              
056329,000036: 04,3270           26101                           <span class="op">ADS     </span> <a href="FLAGWORD_ASSIGNMENTS.agc.html#464C414757524435">FLAGWRD5</a>                              
056330,000037: 
<a name="4143434550545550"></a>056331,000038: 04,3271           34355        <span class="sm">ACCEPTUP</span>           <span class="op">CAF     </span> <a href="PINBALL_GAME__BUTTONS_AND_LIGHTS.agc.html#4348525052494F">CHRPRIO</a>                               <span class="co">#  (NOTE: RUPTREG4 = KEYTEMP1)</span>
056332,000039: 04,3272           05072                           <span class="op">TC      </span> <a href="EXECUTIVE.agc.html#4E4F564143">NOVAC</a>                                 
056333,000040: 04,3273     0776                                  <span class="ps">EBANK=  </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#445350434F554E54">DSPCOUNT</a>                              
056334,000041: 04,3273           02077 60101                     <span class="ps">2CADR   </span> <a href="PINBALL_GAME__BUTTONS_AND_LIGHTS.agc.html#43484152494E">CHARIN</a>                                
056335,000042: 
056336,000043: 04,3275           30073                           <span class="op">CA      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#5255505452454734">RUPTREG4</a>                              
056337,000044: 04,3276           50064                           <span class="op">INDEX   </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4C4F43435452">LOCCTR</a>                                
056338,000045: 04,3277           54154                           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4D504143">MPAC</a>                                  <span class="co">#  LEAVE 5 BIT KEY CDE IN MPAC FOR CHARIN</span>
056339,000046: 04,3300           05270                           <span class="op">TC      </span> <a href="WAITLIST.agc.html#524553554D45">RESUME</a>                                
056340,000047: 
</pre>
</span>
</p>
<table style="text-align: left;" border="1" cellpadding="2" cellspacing="2">
<tbody>
<tr>
<td style="white-space: nowrap; vertical-align: middle;">
<img alt="" src="Apollo32.png" style="width: 32px; height: 32px;" align="left">
</td>
<td style="vertical-align: middle;">
Page 1329
</td></tr></tbody></table>
<p class="nobreak">
<span style="font-family: monospace;">
<pre>
056342,000049:                                                                                                  <span class="co">#  UPRUPT PROGRAM</span>
056343,000050: 
<a name="555052555054"></a>056344,000051: 04,3301           54016        <span class="sm">UPRUPT  </span>           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#42414E4B52555054">BANKRUPT</a>                              
056345,000052: 04,3302           56002                           <span class="op">XCH     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#51">Q</a>                                     
056346,000053: 04,3303           54012                           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#5152555054">QRUPT</a>                                 
056347,000054: 04,3304           04400                           <span class="op">TC      </span> <a href="PINBALL_GAME__BUTTONS_AND_LIGHTS.agc.html#4C4F4453414D5054">LODSAMPT</a>                              <span class="co">#  TIME IS SNATCHED IN RUPT FOR NOUN 65.</span>
056348,000055: 04,3305           34755                           <span class="op">CAF     </span> <a href="FIXED-FIXED_CONSTANT_POOL.agc.html#5A45524F">ZERO</a>                                  
056349,000056: 04,3306           56045                           <span class="op">XCH     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#494E4C494E4B">INLINK</a>                                
056350,000057: 04,3307           54073                           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4B455954454D5031">KEYTEMP1</a>                              
056351,000058: 04,3310           34751                           <span class="op">CAF     </span> <a href="FIXED-FIXED_CONSTANT_POOL.agc.html#42495433">BIT3</a>                                  <span class="co">#  TURN ON UPACT LIGHT</span>
056352,000059: 04,3311           00006                           <span class="op">EXTEND  </span>                                       <span class="co">#  (BIT 3 OF CHANNEL 11)</span>
056353,000060: 04,3312           05011                           <span class="op">WOR     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4453414C4D4F5554">DSALMOUT</a>                              
<a name="555052505431"></a>056354,000061: 04,3313           34346        <span class="sm">UPRPT1  </span>           <span class="op">CAF     </span> <a href="PINBALL_GAME__BUTTONS_AND_LIGHTS.agc.html#4C4F5735">LOW5</a>                                  <span class="co">#  TEST FOR TRIPLE CHAR REDUNDANCY</span>
056355,000062: 04,3314           70073                           <span class="op">MASK    </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4B455954454D5031">KEYTEMP1</a>                              <span class="co">#  LOW5 OF WORD</span>
056356,000063: 04,3315           56073                           <span class="op">XCH     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4B455954454D5031">KEYTEMP1</a>                              <span class="co">#  LOW5 INTO KEYTEMP1</span>
056357,000064: 04,3316           00006                           <span class="op">EXTEND  </span>                                       
056358,000065: 04,3317           74742                           <span class="op">MP      </span> <a href="FIXED-FIXED_CONSTANT_POOL.agc.html#4249543130">BIT10</a>                                 <span class="co">#  SHIFT RIGHT 5</span>
056359,000066: 04,3320           54332                           <span class="op">TS      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4B455954454D5032">KEYTEMP2</a>                              
056360,000067: 04,3321           74346                           <span class="op">MASK    </span> <a href="PINBALL_GAME__BUTTONS_AND_LIGHTS.agc.html#4C4F5735">LOW5</a>                                  <span class="co">#  MID 5</span>
056361,000068: 04,3322           63356                           <span class="op">AD      </span> <a href="#48493130">HI10</a>                                  
056362,000069: 04,3323           03353                           <span class="op">TC      </span> <a href="#555054455354">UPTEST</a>                                
056363,000070: 04,3324           34742                           <span class="op">CAF     </span> <a href="FIXED-FIXED_CONSTANT_POOL.agc.html#4249543130">BIT10</a>                                 
056364,000071: 04,3325           00006                           <span class="op">EXTEND  </span>                                       
056365,000072: 04,3326           70332                           <span class="op">MP      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4B455954454D5032">KEYTEMP2</a>                              <span class="co">#  SHIFT RIGHT 5</span>
056366,000073: 04,3327           74346                           <span class="op">MASK    </span> <a href="PINBALL_GAME__BUTTONS_AND_LIGHTS.agc.html#4C4F5735">LOW5</a>                                  <span class="co">#  HIGH 5</span>
056367,000074: 04,3330           40000                           <span class="op">COM     </span>                                       
056368,000075: 04,3331           03353                           <span class="op">TC      </span> <a href="#555054455354">UPTEST</a>                                
056369,000076: 
<a name="5550434B"></a>056370,000077: 04,3332           43361        <span class="sm">UPCK    </span>           <span class="op">CS      </span> <a href="#454C52434F4445">ELRCODE</a>                               <span class="co">#  CODE IS GOOD. IF CODE = 'ERROR RESET',</span>
056371,000078: 04,3333           60073                           <span class="op">AD      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4B455954454D5031">KEYTEMP1</a>                              <span class="co">#  CLEAR UPLOCKFL(SET BIT4 OF FLAGWRD7 = 0)</span>
056372,000079: 04,3334           00006                           <span class="op">EXTEND  </span>                                       <span class="co">#  IF CODE DOES NOT = 'ERROR RESET', ACCEPT</span>
056373,000080: 04,3335           13343                           <span class="op">BZF     </span> <a href="#434C55504C4F434B">CLUPLOCK</a>                              <span class="co">#  CODE ONLY IF UPLOCKFL IS CLEAR (=0).</span>
056374,000081: 
056375,000082: 04,3336           34750                           <span class="op">CAF     </span> <a href="FLAGWORD_ASSIGNMENTS.agc.html#55504C4F43424954">UPLOCBIT</a>                              <span class="co">#  TEST UPLOCKFL FOR 0 OR 1</span>
056376,000083: 04,3337           70103                           <span class="op">MASK    </span> <a href="FLAGWORD_ASSIGNMENTS.agc.html#464C414757524437">FLAGWRD7</a>                              
056377,000084: 04,3340           10000                           <span class="op">CCS     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#41">A</a>                                     
056378,000085: 04,3341           05270                           <span class="op">TC      </span> <a href="WAITLIST.agc.html#524553554D45">RESUME</a>                                <span class="co">#  UPLOCKFL = 1</span>
056379,000086: 04,3342           03271                           <span class="op">TC      </span> <a href="#4143434550545550">ACCEPTUP</a>                              <span class="co">#  UPLOCKFL = 0</span>
056380,000087: 
<a name="434C55504C4F434B"></a>056381,000088: 04,3343           44750        <span class="sm">CLUPLOCK</span>           <span class="op">CS      </span> <a href="FLAGWORD_ASSIGNMENTS.agc.html#55504C4F43424954">UPLOCBIT</a>                              <span class="co">#  CLEAR UPLOCKFL (I.E., SET BIT 4 OF )</span>
056382,000089: 04,3344           70103                           <span class="op">MASK    </span> <a href="FLAGWORD_ASSIGNMENTS.agc.html#464C414757524437">FLAGWRD7</a>                              <span class="co">#  FLAGWRD7 = 0)</span>
056383,000090: 04,3345           54103                           <span class="op">TS      </span> <a href="FLAGWORD_ASSIGNMENTS.agc.html#464C414757524437">FLAGWRD7</a>                              
056384,000091: 04,3346           03271                           <span class="op">TC      </span> <a href="#4143434550545550">ACCEPTUP</a>                              
056385,000092: 
056386,000093:                                                                                                  <span class="co">#  CODE IS BAD</span>
<a name="544D4641494C32"></a>056387,000094: 04,3347           40103        <span class="sm">TMFAIL2 </span>           <span class="op">CS      </span> <a href="FLAGWORD_ASSIGNMENTS.agc.html#464C414757524437">FLAGWRD7</a>                              <span class="co">#  LOCK OUT FURTHER UPLINK ACTIVITY</span>
056388,000095: 04,3350           74750                           <span class="op">MASK    </span> <a href="FLAGWORD_ASSIGNMENTS.agc.html#55504C4F43424954">UPLOCBIT</a>                              <span class="co">#  (BY SETTING UPLOCKFL = 1) UNTIL</span>
056389,000096: 04,3351           26103                           <span class="op">ADS     </span> <a href="FLAGWORD_ASSIGNMENTS.agc.html#464C414757524437">FLAGWRD7</a>                              <span class="co">#  'ERROR RESET' IS SENT VIA UPLINK.</span>
056390,000097: 04,3352           05270                           <span class="op">TC      </span> <a href="WAITLIST.agc.html#524553554D45">RESUME</a>                                
<a name="555054455354"></a>056391,000098: 04,3353           60073        <span class="sm">UPTEST  </span>           <span class="op">AD      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#4B455954454D5031">KEYTEMP1</a>                              
</pre>
</span>
</p>
<table style="text-align: left;" border="1" cellpadding="2" cellspacing="2">
<tbody>
<tr>
<td style="white-space: nowrap; vertical-align: middle;">
<img alt="" src="Apollo32.png" style="width: 32px; height: 32px;" align="left">
</td>
<td style="vertical-align: middle;">
Page 1330
</td></tr></tbody></table>
<p class="nobreak">
<span style="font-family: monospace;">
<pre>
056393,000100: 04,3354           10000                           <span class="op">CCS     </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#41">A</a>                                     
056394,000101: 04,3355           03347                           <span class="op">TC      </span> <a href="#544D4641494C32">TMFAIL2</a>                               
<a name="48493130"></a>056395,000102: 04,3356           77740        <span class="sm">HI10    </span>           <span class="ps">OCT     </span> 77740                                 
056396,000103: 04,3357           03347                           <span class="op">TC      </span> <a href="#544D4641494C32">TMFAIL2</a>                               
056397,000104: 04,3360           00002                           <span class="op">TC      </span> <a href="ERASABLE_ASSIGNMENTS.agc.html#51">Q</a>                                     
056398,000105: 
<a name="454C52434F4445"></a>056399,000106: 04,3361           00022        <span class="sm">ELRCODE </span>           <span class="ps">OCT     </span> 22                                    
056400,000107: 
056401,000108:                                                                                                  <span class="co">#  'UPLINK ACTIVITY LIGHT' IS TURNED OFF BY .....</span>
056402,000109:                                                                                                  <span class="co">#           1.     VBRELDSP</span>
056403,000110:                                                                                                  <span class="co">#           2.     ERROR RESET</span>
056404,000111:                                                                                                  <span class="co">#           3.     UPDATE PROGRAM (P27) ENTERED BY V70,V71,V72, AND V73.</span>
056405,000112:                                                                                                  <span class="co">#                                     -</span>
056406,000113:                                                                                                  <span class="co">#  THE RECEPTION OF A BAD CODE (I.E  CCC FAILURE) LOCKS OUT FURTHER UPLINK ACTIVITY BY SETTING BIT4 OF FLAGWRD7 = 1.</span>
056407,000114:                                                                                                  <span class="co">#  THIS INDICATION WILL BE TRANSFERRED TO THE GROUND BY THE DOWNLINK WHICH DOWNLINKS ALL FLAGWORDS.</span>
056408,000115:                                                                                                  <span class="co">#  WHEN UPLINK ACTIVITY IS LOCKED OUT, IT CAN BE ALLOWED WHEN THE GROUND UPLINKS AND 'ERROR RESET' CODE.</span>
056409,000116:                                                                                                  <span class="co">#  (IT IS RECOMMENDED THAT THE 'ERROR LIGHT RESET' CODE IS PRECEEDED BY 16 BITS THE FIRST OF WHICH IS 1 FOLLOWED</span>
056410,000117:                                                                                                  <span class="co">#  BY 15 ZEROES. THIS WILL ELIMINATE EXTRANEOUS BITS FROM INLINK WHICH MAY HAVE BEEN LEFT OVER FROM THE ORIGINAL</span>
056411,000118:                                                                                                  <span class="co">#  FAILURE)</span>
056412,000119: 
056413,000120:                                                                                                  <span class="co">#  UPLINK ACTIVITY IS ALSO ALLOWED (UNLOCKED) DURING FRESH START WHEN FRESH START SETS BIT4 OF FLAGWRD7 = 0.</span>
056414,000121: 

End of include-file KEYRUPT,_UPRUPT.agc.  Parent file is <a href="MAIN.agc.html">MAIN.agc</a>
</pre>
</span>
</p>
</body>
</html>
